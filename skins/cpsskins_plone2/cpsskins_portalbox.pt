<div i18n:domain="plone"
tal:define="context_rurl request/form/context_rurl|nothing;
            context_obj python: here.cpsskins_getContextObj(context_rurl);
            portal_url here/portal_url;
            orientation python: here.orientation; 
            menustyle python: orientation == 'vertical' and 'display: block' or 'display: inline';
            item_style python: orientation == 'horizontal' and 'white-space: nowrap' or None;
            boxlayout python: here.boxlayout;
            boxlayout python: boxlayout == '' and 'standard' or boxlayout;
            boxlayout_macro_path here/cpsskins_BoxLayouts/macros/?boxlayout|here/cpsskins_BoxLayouts/macros/standard;
            box_title_i18n python: here.box_title_i18n;
            content python: here.content"
 tal:attributes="class string:BoxColor${here/boxcolor} BoxShape${here/boxshape};
                 style python: 'text-align: %s' % here.align">

 <tal:block condition="python: content == 'folders'">
   <tal:block define="level python: here.level;
          base python: here.base;
          show_docs python: here.show_docs;
          base_path python: here.base_path;
          navigationinfo python: here.cpsskins_getNavigationInfo(level=level, base=base, show_docs=show_docs, base_path=base_path, context_rurl=context_rurl);
          menuentries navigationinfo/menuentries|nothing; 
          create_url navigationinfo/create_url|nothing;
          i18n python: here.folder_items_i18n"
  condition="python: menuentries or create_url">
    <metal:block use-macro="boxlayout_macro_path">
     <metal:block fill-slot="box_title" >
       <metal:block use-macro="here/cpsskins_portalbox_macros/macros/title" />
     </metal:block>
     <metal:block fill-slot="box_body" >
      <tal:block condition="i18n" repeat="menuentry menuentries">
        <tal:block
        define="menu_url python: menuentry['url']; 
                menu_selected python: menuentry['selected'];
                menu_title python: menuentry['title'];
                menuclass python: menu_selected and 'submenuin' or 'submenuout';
                iconclass python: menu_selected and 'menuinicon' or 'menuouticon'">
          <a href="" 
            tal:attributes="href menu_url; class menuclass; style menustyle">
           <span tal:attributes="class iconclass">&nbsp;</span>
           <span i18n:translate="" tal:content="structure menu_title" tal:attributes="style item_style" />
          </a>
        </tal:block>
      </tal:block>
      <tal:block condition="not:i18n" repeat="menuentry menuentries">
        <tal:block
        define="menu_url python: menuentry['url']; 
                menu_selected python: menuentry['selected'];
                menu_title python: menuentry['title'];
                menuclass python: menu_selected and 'submenuin' or 'submenuout';
                iconclass python: menu_selected and 'menuinicon' or 'menuouticon'">
          <a href="" 
            tal:attributes="href menu_url; class menuclass; style menustyle">
           <span tal:attributes="class iconclass">&nbsp;</span>
           <span tal:content="structure menu_title" tal:attributes="style item_style" />
          </a>
        </tal:block>
      </tal:block>
      <tal:block define="url create_url|nothing">
        <span>&nbsp;
         <a class="addmenu" tal:attributes="href url" 
            tal:condition="url">
            &nbsp;+&nbsp;</a>
        </span>
      </tal:block>
     </metal:block>
    </metal:block>
  </tal:block>
 </tal:block>

 <tal:block condition="python: content == 'actions'">
  <tal:block
  define="wtool here/portal_workflow; 
          actioninfos python: here.cpsskins_getActionsInfo(here, context_obj);
          space python: orientation == 'vertical' and 'margin-top: 9px;;' or ''"
  condition="actioninfos">
    <metal:block use-macro="boxlayout_macro_path">
     <metal:block fill-slot="box_title" >
       <metal:block use-macro="here/cpsskins_portalbox_macros/macros/title" />
     </metal:block>
     <metal:block fill-slot="box_body" >
      <tal:block repeat="actioninfo actioninfos">
         <tal:block define="we_are_here python: actioninfo['we_are_here'];
                          title python: actioninfo['title'];
                          url python: actioninfo['url'];
                          class python: actioninfo['class'];
                          style python: actioninfo['style'];
                          newcat python: actioninfo['newcat'];
                          style python: newcat and style + space or '';
                          iconclass python: we_are_here and 'menuinicon' or 'menuouticon'">
              <a tal:attributes="style string: $style $menustyle;
                                 class class;
                                 href url">
                <span tal:attributes="class iconclass">&nbsp;</span><span i18n:translate="" tal:content="title" tal:attributes="style item_style" />
              </a>
         </tal:block>
      </tal:block>
     </metal:block>
    </metal:block>
  </tal:block>
 </tal:block>

 <tal:block condition="python: content == 'about'" i18n:domain="cpsskins">
    <metal:block use-macro="boxlayout_macro_path">
     <metal:block fill-slot="box_title" >
       <metal:block use-macro="here/cpsskins_portalbox_macros/macros/title" />
     </metal:block>
     <metal:block fill-slot="box_body">
       <tal:block define="content here/content|nothing;
                     modification_date context_obj/ModificationDate;
                     creator context_obj/Creator;
                     ti python: context_obj.getTypeInfo();
                     doctype python: ti and ti.Title() or nothing;
                     creator_home python:container.portal_membership.getHomeUrl(creator)">
         <p>
           <img tal:attributes="src string:$portal_url/${context_obj/getIcon}" alt="" />
           <tal:block condition="doctype" content="doctype" /> 
         </p>
         <p>
           <strong tal:define="title string:_Created by:_" i18n:translate="" 
            tal:content="title" /><br/>
             <a href="#" tal:condition="creator_home"
                     tal:attributes="href creator_home"
                     tal:content="creator" />
           <tal:block condition="not: creator_home"
                     replace="creator" />
         </p>
         <p>
           <strong tal:define="title string:_Last modified:_"  i18n:translate="" 
            tal:content="title" /><br/>
           <tal:block replace="modification_date" />
         </p>
       </tal:block>
     </metal:block>
   </metal:block>
 </tal:block>

 <tal:block condition="python: content == 'login'" i18n:domain="cpsskins">
    <metal:block use-macro="boxlayout_macro_path">
     <metal:block fill-slot="box_title" >
       <metal:block use-macro="here/cpsskins_portalbox_macros/macros/title" />
     </metal:block>
     <metal:block fill-slot="box_body">
      <form action="logged_in"
           method="post"
           tal:attributes="action string:$portal_url/logged_in">
           <input type="hidden" name="came_from" value=""
                  tal:define="came_from request/came_from|nothing"
                  tal:condition="came_from"
                  tal:attributes="value came_from">
           <span i18n:translate="" tal:define="title string:_Username_"
            tal:content="title" /> <br />
           <input type="text" name="__ac_name" size="12"
            tal:attributes="value python:request.get('__ac_name', '');" alt="Username" title="Username" />
           <br />
           <span i18n:translate=""  tal:define="title string:_Password_"
            tal:content="title" /> <br />
           <input type="password" name="__ac_password" size="12" alt="Password" title="Password" /> <br />
           <input i18n:attributes="value" type="submit"  name="submit" 
            tal:define="title string:_Log in_"
            tal:attributes="value title" />
     </form>
     <br/>
     <a tal:attributes="href string:$portal_url/mail_password_form"
        i18n:translate="" tal:define="title string:_Forgot your password?_"
        tal:content="title"/>
    </metal:block>
  </metal:block>
 </tal:block>

 <tal:block condition="python: content == 'info'">
   <metal:block use-macro="boxlayout_macro_path">
     <metal:block fill-slot="box_title" >
       <metal:block use-macro="here/cpsskins_portalbox_macros/macros/title" />
     </metal:block>
     <metal:block fill-slot="box_body">
      <tal:block
        define="info python: here.info;
                pss modules/Products/PythonScripts/standard; 
                structured_text here/structured_text|nothing;"
        condition="info"
        content="structure python:pss.structured_text(info)" />
     </metal:block>
   </metal:block>
 </tal:block>

 <tal:block condition="python: content == 'related'">
   <tal:block define="RelatedDocuments context_obj/cpsskins_RelatedDocuments"
              condition="RelatedDocuments">
     <metal:block use-macro="boxlayout_macro_path">
       <metal:block fill-slot="box_title" >
         <metal:block use-macro="here/cpsskins_portalbox_macros/macros/title" />
       </metal:block>
       <metal:block fill-slot="box_body">
         <div tal:repeat="related RelatedDocuments" class="submenuout">
           <img src="" 
             tal:attributes="src string:$portal_url/${related/icon}; alt context_obj/title" />
           <a href="" tal:attributes="href string:${related/url}/view"
                     tal:content="related/title" />
         </div>
       </metal:block>
     </metal:block>
   </tal:block>
 </tal:block>

 <tal:block condition="python: content == 'recent'" i18n:domain="cpsskins">
   <tal:block define="isAnon here/portal_membership/isAnonymousUser"
              condition="not:isAnon">
     <tal:block condition="results" define="results here/cpsskins_RecentDocuments">
       <metal:block use-macro="boxlayout_macro_path">
         <metal:block fill-slot="box_title" >
           <metal:block use-macro="here/cpsskins_portalbox_macros/macros/title" />
         </metal:block>
         <metal:block fill-slot="box_body">
             <tal:block tal:repeat="obj results">
                <div class="submenuout">
                    <img src="" 
                       tal:attributes="src string:$portal_url/${obj/icon}; alt obj/title" />
                    <a href=""
                       tal:attributes="href string:${obj/url}/view"
                       tal:content="obj/title"/> 
                </div>
            </tal:block>
            <span tal:condition="not: results"
                 i18n:translate="" 
                 tal:define="title string:_No items published since your last log-in_"
                 tal:content="title" />
         </metal:block>
       </metal:block>
     </tal:block>
   </tal:block>
 </tal:block>

 <tal:block condition="python: content == 'events'">
   <tal:block define="results here/cpsskins_getEvents"
              condition="results">
     <metal:block use-macro="boxlayout_macro_path">
       <metal:block fill-slot="box_title" >
         <metal:block use-macro="here/cpsskins_portalbox_macros/macros/title" />
       </metal:block>
       <metal:block fill-slot="box_body">
         <tal:block tal:repeat="obj results">
           <div class="submenuout">
             <img src=""
              tal:attributes="src string:$portal_url/${obj/icon}; alt obj/title" />
             <a href=""
              tal:attributes="href string:${obj/url}/view"
               tal:content="obj/title"/>,
             <tal:block define="location obj/location"
                        condition="location"
                        content="location" /><br />
             <tal:block content="obj/start" />
           </div>
         </tal:block>
       </metal:block>
     </metal:block>
   </tal:block>
 </tal:block>

 <tal:block condition="python: content == 'pending'">
   <tal:block define="results here/cpsskins_getPending"
              condition="results">         
     <metal:block use-macro="boxlayout_macro_path">
       <metal:block fill-slot="box_title" >
         <metal:block use-macro="here/cpsskins_portalbox_macros/macros/title" />
       </metal:block>                      
       <metal:block fill-slot="box_body">  
         <tal:block tal:repeat="obj results">
           <div class="submenuout">        
             <img src=""                   
              tal:attributes="src string:$portal_url/${obj/icon}; alt obj/title" />
             <a href=""                    
              tal:attributes="href string:${obj/absolute_url}/view"
               tal:content="obj/title_or_id"/>
           </div>                          
         </tal:block>                      
       </metal:block>
     </metal:block> 
   </tal:block>     
 </tal:block>   

 <tal:block condition="python: content == 'language'" i18n:domain="cpsskins">
   <tal:block define="portal_languages nocall:here/portal_languages|nothing"
             condition="nocall:portal_languages">
     <tal:block condition="python: len(served_languages) <= 8"
              define="served_languages portal_languages/listSupportedLanguages|nothing;
                      boundLanguages portal_languages/getLanguageBindings|nothing;
                      prefLang python:boundLanguages and boundLanguages[0] or None">
       <metal:block use-macro="boxlayout_macro_path">
         <metal:block fill-slot="box_title" >
           <tal:block define="title string:_Language selector_" i18n:translate="" tal:content="title" />
         </metal:block>
         <metal:block fill-slot="box_body"
           tal:condition="python:len(served_languages) <= 8"
           tal:repeat="lang served_languages">
           <strong tal:define="code python: lang[0];
                             title python: lang[1]"
                 tal:omit-tag="python:prefLang != code" >
             <img width="15" height="12" alt=""
              tal:attributes="src string:${portal_url}/cpsskins_images/flag-${code}.gif;
                            title title" />
             <a href="" 
              tal:attributes="href string:${portal_url}/switchLanguage?set_language=${code}"
              tal:content="python:portal_languages.getNameForLanguageCode(code) or title" /><br/>
           </strong>
         </metal:block>
       </metal:block>
     </tal:block>
   </tal:block>
 </tal:block>
</div>
