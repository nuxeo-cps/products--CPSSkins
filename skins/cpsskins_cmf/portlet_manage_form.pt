<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html tal:define="global boxedit python:1;
                  utool nocall:here/portal_url;
                  mcat python: here.cpsskins_getlocalizer();
                  mtool here/portal_membership;
                  ptltool nocall:here/portal_cpsportlets;
                  tmtool here/portal_themes;
                  context_url python:here.getContextUrl(utool=utool);
                  base_url python: here.cpsskins_getBaseUrl();
                  view_mode tmtool/getViewMode;
                  wysiwyg view_mode/wysiwyg|python:0;
                  panel view_mode/portlets_panel|string:site_structure;
                  selected_portlet view_mode/selected_portlet|nothing;
                  cpsmcat python: here.cpsskins_getlocalizer(cat='default');
                  checkPerm nocall:mtool/checkPermission">
<head>
  <style type="text/css" media="all"
   tal:content="string: @import url(${here/portal_url}/cpsskins_theme_edit.css);" />
  <script type="text/javascript" src="cpsskins_pdlib.js"></script>
  <script type="text/javascript" src="cpsskins_portlet_edit.js"></script>
</head>

<metal:block use-macro="here/cpsskins_global_defines/macros/defines" />

<div class="editspace"
 tal:condition="python: panel == 'wysiwyg'">
  <metal:block use-macro="here/main_template/macros/master">
    <metal:block fill-slot="main">
      <div style="border: 1px solid black; padding: 20px;">Main slot</div>
    </metal:block>
  </metal:block>
</div>

<body>
  <div class="floatingheader">
   <metal:block 
    use-macro="here/cpsskins_portlet_manage_lib/macros/navigate" />
   <metal:block
    use-macro="here/cpsskins_portlet_manage_lib/macros/portlet_add_panel" />
  </div>

  <div class="editspace">
    <tal:block 
     define="hidden_slots python: here.cpsskins_listHiddenSlots(theme=current_theme)" 
     condition="python: hidden_slots and panel=='unused_portlets'">
      <metal:block use-macro="here/cpsskins_portlet_manage_lib/macros/unused_portlets_panel" />
    </tal:block>

    <tal:block
     condition="python: panel == 'site_structure'">
      <metal:block use-macro="here/cpsskins_portlet_manage_lib/macros/site_structure" />
    </tal:block> 

    <tal:block
     condition="python: panel == 'portlet_slots'">
      <metal:block use-macro="here/cpsskins_portlet_manage_lib/macros/main_canvas" />
    </tal:block> 

    <tal:block
     condition="python: panel == 'portlet_browser'">
      <metal:block use-macro="here/cpsskins_portlet_manage_lib/macros/browser_panel" />
    </tal:block> 
  </div>

  <metal:block use-macro="here/cpsskins_portlet_manage_lib/macros/contextual_menu" />

  <!-- Begin pdlib footer -->
  <div id="drag-feedback-box"></div>
    <script type="text/javascript"><!-- 
    pd_setupPage();
    // --></script>
  <!-- End pdlib footer -->

  </body>
</html>
