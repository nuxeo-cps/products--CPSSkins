<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<metal:block use-macro="here/cpsskins_edit_macro/macros/edit" i18n:domain="cpsskins"> 
  <metal:block fill-slot="edit"
  tal:define="current_image request/form/current_image|nothing; 
              imagecat request/form/imagecat|nothing; 
              sections here/cpsskins_listImageCategories; 
              pss modules/Products/PythonScripts/standard;
              mtool here/portal_membership;
              checkPerm nocall:mtool/checkPermission">
    <tal:block condition="python: not checkPerm('Manage Themes', here)"> 
      <tal:block define="dummy request/RESPONSE/unauthorized" />
    </tal:block>
    <metal:block use-macro="here/cpsskins_form_widgets/macros/imagenavigation" />
    <tal:block condition="python: imagecat not in sections">
      <h1 tal:define="title string:_Edit images_"
      tal:content="python: mcat and mcat(title) or title"
      i18n:translate="" />
      <table cellpadding="3" cellspacing="0" border="0" summary="">
        <tal:block repeat="imagecat sections">
          <tr>
            <td>
              <img tal:attributes="src string:${base_url}themefolder.png" />
            </td>
            <td>
              <a tal:define="imagecat_quoted python: pss.url_quote_plus(imagecat);
                             title python:'_%s_' % imagecat"
                 tal:attributes="href string:${here_url}/cpsskins_edit_images?imagecat=$imagecat_quoted&amp;theme=$current_theme"
                 i18n:translate="" 
                 tal:content="python: mcat and mcat(title) or title" />
            </td>
          </tr>
        </tal:block>
      </table>
    </tal:block>
    <tal:block condition="python: imagecat in sections">
      <h1 tal:define="title python:'_%s_' % imagecat"
      tal:content="python: mcat and mcat(title) or title"
      i18n:translate="" />
      <tal:block define="images python: here.cpsskins_listImages(imagecat=imagecat)">
        <tal:block repeat="image images">
          <div tal:define="image_url image/absolute_url;
                           image_title image/title"
               tal:attributes="class python: current_image and image_title == current_image and 'EditPreviewSelected' or 'EditPreview'">
            <a title="Delete" 
            tal:define="msg string:_Deleting this image, are you sure?_;
                        msg python: cpsskins_mcat and cpsskins_mcat(msg) or msg;
                        onclick_msg python:'return window.confirm(\'%s\')' % msg"
            tal:attributes="onclick onclick_msg;
              href string:${image_url}/cpsskins_object_delete?goto=referer" >
              <img border="0" width="12" height="12"
              tal:attributes="src string:${base_url}cpsskins_images/img_image_delete.png" />
            </a>
            <a tal:attributes="href string:${image_url}/cpsskins_image_edit_form?imagecat=$imagecat">
              <strong tal:content="image_title" />
              <br />
              <tal:block content="string:${image/size} bytes" />
              <tal:block content="string:(${image/width}x${image/height} px)" />
              <br />
              <br />
              <img tal:condition="python: imagecat == 'icons'"
              tal:attributes="width python: '%spx' % test(image.width > 200, 200, image.width); src image_url" />
              <img tal:condition="python: imagecat == 'thumbnails'"
               width="200" tal:attributes="src image_url" />
              <div class="backgroundeditbox"
              tal:condition="python: imagecat == 'backgrounds'"
              tal:attributes="style string:background: url('${image_url}');;">
              </div>
            </a>
          </div>
        </tal:block>
        <form tal:attributes="action python: '%s/cpsskins_addimage_form' % imagecat"
              method="get">
          <input type="hidden" name="theme" value=""
          tal:attributes="value current_theme" />
          <input type="hidden" name="edit_mode" value=""
          tal:attributes="value edit_mode" />
          <input type="image" type="submit" width="46" height="18"
          tal:attributes="src string:${base_url}cpsskins_images/img_addimage.png" />
        </form>
      </tal:block>
    </tal:block>
  </metal:block>
</metal:block>
