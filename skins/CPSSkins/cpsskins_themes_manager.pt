<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<metal:block use-macro="here/cpsskins_edit_macro/macros/edit" i18n:domain="cpsskins">
  <metal:block fill-slot="edit"
  tal:define="tmtool here/portal_themes; 
              themes python: tmtool.getThemes();
              current_theme request/form/theme|nothing">
    <tal:block condition="python: not here.portal_membership.checkPermission('Manage Themes', here)"> 
      <tal:block define="dummy request/RESPONSE/unauthorized" />
    </tal:block>
    <h1 tal:define="title string:_Themes manager_"
    tal:content="python: mcat and mcat(title) or title"
    i18n:translate="" />
      <metal:block use-macro="here/cpsskins_theme_widgets/macros/theme_upload" />
      <br/>
      <form action="" method="post"
        tal:attributes="action string:${base_url}cpsskins_themes_edit">
        <input type="hidden" name="theme"
        tal:attributes="value current_theme" />
        <input type="hidden" name="edit_mode" value=""    
        tal:attributes="value edit_mode" />   
        <table border="0" cellpadding="2" cellspacing="0"
        width="100%">
          <tr>
             <td>
                 <strong i18n:translate=""
                  tal:define="title string:_Theme name_"
                  tal:content="python: mcat and mcat(title) or title" />
             </td>
             <td align="center">
                 <strong i18n:translate="" 
                  tal:define="title string:_Default theme_"
                  tal:content="python: mcat and mcat(title) or title" />
             </td>
             <td>
                 <strong i18n:translate="" 
                  tal:define="title string:_Theme renderer_"
                  tal:content="python: mcat and mcat(title) or title" />
             </td>
             <td align="center">
                 <strong i18n:translate="" 
                  tal:define="title string:_Delete theme?_"
                  tal:content="python: mcat and mcat(title) or title" />
             </td>
          </tr>
          <tal:block repeat="theme themes">
              <tr tal:define="default_theme theme/default|nothing;
                              theme_renderer theme/theme_renderer|nothing;
                              theme_id theme/id|nothing;
                              renderers tmtool/listThemeRenderers"
                  tal:attributes="style python: theme_id == current_theme and 'background-color: #d0d0d0' or ''">
                  <td>
                    <img align="middle" alt=""
                    tal:attributes="src string:${base_url}${theme/getIcon}" />
                    <a tal:attributes="href string:${theme/absolute_url}/edit_form?theme=$theme_id&edit_mode=$edit_mode;
                                       style python: default_theme and 'font-weight: bold' or ''"
                       tal:content="python: '%s (%s)' % (theme_id, theme.title_or_id())" />
                  </td>
                  <td align="center">
                    <input type="radio" name="default_theme:list"
                    value="."
                    tal:attributes="checked default_theme; value theme_id" />
                  </td>
                  <td>
                     <select name="theme_renderers">
                       <tal:block repeat="renderer renderers">
                         <option i18n:translate=""
                          tal:define="title python: '_option_%s_' % renderer"
                          tal:attributes="value renderer;
                                           selected python: renderer == theme_renderer"
                                 tal:content="python: mcat and mcat(title) or title" />
                       </tal:block>
                     </select>
                  </td>
                  <td align="center">
                    <input type="checkbox" name="delete_themes:list"
                    value="."
                    tal:attributes="value theme_id" />
                  </td>
              </tr>
          </tal:block>
        </table>
        <div class="form_submit">
          <input type="submit" class="mainbutton"
          i18n:attributes="value" 
          tal:define="title string:_button_modify_"
          tal:attributes="value python:mcat and mcat(title) or title" />
        </div>
      </form>
      <form action="cpsskins_theme_add" method="get">
        <input type="hidden" name="theme" value=""    
        tal:attributes="value current_theme" />   
        <input type="hidden" name="edit_mode" value=""    
        tal:attributes="value edit_mode" />   
        <input type="image" type="submit" 
        tal:attributes="src string:${base_url}cpsskins_images/img_addtheme.png" />
      </form>
  </metal:block>
</metal:block>
